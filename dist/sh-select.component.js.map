{"version":3,"file":"sh-select.component.js","sourceRoot":"","sources":["../src/sh-select.component.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Created by yonifarin on 12/3/16.\n */\nimport {\n    Component, OnInit, ElementRef, Input, forwardRef, ViewChild, Renderer, Output,\n    EventEmitter\n} from '@angular/core';\nimport {ControlValueAccessor, NG_VALUE_ACCESSOR} from \"@angular/forms\";\nimport {filter} from \"rxjs/operator/filter\";\n\n@ Component({\n    selector: 'sh-select',\n    template:`<div class=\"header\" [class.sh-select-disabled]=\"disabled\" [class.inline]=\"mode==='inline'\"\n     (click)=\"show()\" [class.open]=\"isOpen\">\n    <input type=\"text\"\n           #inputFilter\n           [hidden]=\"!isOpen\"\n           (click)=\"show()\"\n           [placeholder]=\"placeholder\"\n           [(ngModel)]=\"filter\"\n           (ngModelChange)=\"updateFilter($event)\">\n    <div (click)=\"show(); $event.stopPropagation()\"\n\n         *ngIf=\"!isOpen\">\n        {{selectedValues?.length \n        ? (isMultiselect ? selectedValues?.length + ' Selected' : (selectedValues[0].name || selectedValues))\n        : placeholder}}\n    </div>\n    <i class=\"close icon clear\"\n       *ngIf=\"showClear && selectedValues.length > 0\"\n       (click)=\"clear(); $event.stopPropagation()\"></i>\n</div>\n<sh-select-menu [isOpen]=\"isOpen\"\n                [rows]=\"rows\"\n                [selectedValues]=\"selectedValues\"\n                (noToggleClick)=\"toggleSelected($event)\"></sh-select-menu>`,\n    styles:[`:host{\n    display: block;\n    position: relative;\n    width: 100%;\n    padding: 0;\n    margin: 0;\n    font-family: 'RobotoDraft', 'Roboto', 'Helvetica Neue, Helvetica, Arial', sans-serif;\n    font-style: normal;\n    font-weight: 300;\n    font-size: 1.0rem;\n    line-height: 2rem;\n    letter-spacing: 0.01rem;\n    color: #212121;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    text-rendering: optimizeLegibility;\n}\n\n.header{\n    width: 100%;\n    margin: 0 !important;\n    padding: 2px 30px 2px 10px;\n    box-sizing: border-box;\n    background-color: white;\n    font-size: 1.0em;\n    border-radius: 2px;\n    border: 1px solid rgba(34,36,38,.15);\n    vertical-align: middle;\n    cursor: pointer;\n}\n\n.header.inline{\n    background-color: transparent;\n    width: max-content;\n    border: none;\n}\n\n.header.open{\n    border-radius: 2px 2px 0 0;\n    box-shadow: 0 2px 3px 0 rgba(34,36,38,.15);\n    border-bottom: none;\n}\n\ndiv{\n    display: block;\n}\n\ninput[type=\"text\"]{\n    border: none !important;\n    vertical-align: middle !important;\n    width: 100%;\n    margin: 0 !important;\n    padding: 0px !important;\n    box-sizing: border-box;\n    background-color: white;\n    font-size: 1.0rem !important;\n    line-height: 2rem !important;\n    letter-spacing: 0.01rem !important;\n    font-family: 'RobotoDraft', 'Roboto', 'Helvetica Neue, Helvetica, Arial', sans-serif;\n    font-style: normal !important;\n    font-weight: 300 !important;\n    -webkit-font-smoothing: antialiased !important;\n    -moz-osx-font-smoothing: grayscale !important;;\n    text-rendering: optimizeLegibility !important;;\n}\n\ninput[type=\"text\"] { outline: none; }\n\n\n[hidden]{\n    display: none;\n}\n\ni.close.icon.clear::after {     \n    content: \"âœ•\";\n    padding-right: 8px;\n    font-weight: 800;\n    color: gray; \n}\n\ni.close.icon.clear:hover::after {\n    color: red; \n}\n\n.clear{\n    position: absolute;\n    right: 2px;\n    padding-left: 2px;\n    padding-right: 2px;\n    top:3px;\n    cursor: pointer;\n}\n.sh-select-disabled{\n    background-color: #e3e3e3;\n    color: darkgray;\n    cursor: not-allowed;\n}\n\n`],\n    host: {\n        '(window:mouseup)': 'onDocumentClick($event)'\n    },\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: ShSelectProvider(),\n            multi: true\n        }\n    ]\n})\nexport class ShSelectComponent implements ControlValueAccessor, OnInit {\n    @Input() placeholder:string = \"Type to filter\";\n    @Input() isMultiselect:boolean = false;\n    @Input() rawOptionGenerator:Function = null;\n    @Input() mode:\"default\" | \"inline\" = \"default\";\n    @Input() showClear:boolean = true;\n    @Input() disabled:boolean;\n    @ViewChild('inputFilter') inputFilter:ElementRef;\n    @Input() set options(val:any[]){\n        this._options = val;\n        this.updateRows(val);\n    }\n    get options():any[]{\n        return this._options;\n    }\n    @Output() onHide:EventEmitter<any[]> = new EventEmitter<any[]>();\n    @Output() onShow:EventEmitter<any[]> = new EventEmitter<any[]>();\n    @Output() onClear:EventEmitter<any[]> = new EventEmitter<any[]>();\n\n    rows:any[] =[];\n    _options:any[] = [];\n    isOpen:boolean;\n    filter:string;\n    filteredData:any[] = [];\n    _selectedValues:any[] =[];\n    get selectedValues():any[]{\n        return this._selectedValues;\n    };\n\n    set selectedValues(val:any[]){\n        if(!val) val =[];\n\n        if(!Array.isArray(val))\n            val = [val];\n\n        this._selectedValues = val;\n    }\n\n    constructor(private element:ElementRef,\n                private renderer: Renderer) {\n    }\n\n    /**\n     * on click outside the view close the menu\n     * @param event\n     */\n    onDocumentClick(event) {\n        if (this.isOpen && !this.element.nativeElement.contains(event.target))\n            this.hide();\n    }\n\n    updateRows(val:any[] =[]){\n        this.rows = val;\n    }\n\n    updateFilter(filter){\n        const lowercaseFilter = filter.toLocaleLowerCase();\n        this.filteredData = this._options.filter(item =>\n            !lowercaseFilter || (item.name || item).toLowerCase().indexOf(lowercaseFilter) !== -1);\n        if (!this.isMultiselect && this.rawOptionGenerator) {\n            const rawOption = this.rawOptionGenerator(filter);\n            if (rawOption) this.filteredData.unshift(rawOption);\n        }\n        this.updateRows(this.filteredData);\n    }\n\n    clearFilter(){\n        if(this.filter === \"\") return;\n\n        this.filter = \"\";\n        this.updateFilter(this.filter);\n    }\n\n    toggleSelected(item){\n        if(!item) return;\n        this.clearFilter();\n\n        if(this.isMultiselect)\n            this.selectMultiple(item);\n        else{\n            this.selectSingle(item)\n        }\n\n        this.propagateChange(this._selectedValues);\n    }\n\n    selectSingle(item){\n        this._selectedValues.splice(0, this.rows.length);\n        this._selectedValues.push(item);\n        this.hide();\n    }\n\n    selectMultiple(item){\n        if(this.selectedValues.indexOf(item) == -1){\n            this.selectedValues.push(item);\n        }\n        else{\n            this.selectedValues.splice(this.selectedValues.indexOf(item),1);\n        }\n    }\n\n    focusFilter(){\n        setTimeout(()=>{\n            this.renderer.invokeElementMethod(this.inputFilter.nativeElement, 'focus');\n        },0);\n    }\n\n    show(){\n        if(this.isOpen || this.disabled) return;\n\n        this.isOpen = true;\n        this.focusFilter();\n        this.onShow.emit();\n    }\n\n    hide(){\n        this.isOpen = false;\n        this.clearFilter();\n        this.onHide.emit();\n    }\n\n    clear(){\n        if(this.disabled) return;\n\n        this.selectedValues = [];\n        this.propagateChange(this._selectedValues);\n        this.onClear.emit();\n    }\n\n    ngOnInit() {\n    }\n\n    //////// ControlValueAccessor imp //////////\n\n    writeValue(value: any) {\n        this.selectedValues = value;\n    }\n\n    propagateChange = (_: any) => {};\n\n    registerOnChange(fn) {\n        this.propagateChange = fn;\n    }\n\n    registerOnTouched() {}\n}\n\nexport function ShSelectProvider():any{\n    return forwardRef(() =>ShSelectComponent);\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}